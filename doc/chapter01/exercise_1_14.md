# [Глава 1](./index.md#Глава-1-Построение-абстракций-с-помощью-процедур)

## Упражнение 1.14

Нарисуйте дерево, иллюстрирующее процесс, который порождается процедурой count-change при размене 11 центов. Каковы порядки роста памяти и числа шагов, используемых этим процессом при увеличении суммы, которую требуется разменять?

```racket
(define (count-change amount)
  (cc amount 5))

(define (cc amount kinds-of-coins)
  (cond ((= amount 0) 1)
        ((or (< amount 0) (= kinds-of-coins 0)) 0)
        (else (+ (cc amount
                     (- kinds-of-coins 1))
                 (cc (- amount
                        (first-denomination kinds-of-coins))
                     kinds-of-coins)))))

(define (first-denomination kinds-of-coins)
  (cond ((= kinds-of-coins 1) 1)
        ((= kinds-of-coins 2) 5)
        ((= kinds-of-coins 3) 10)
        ((= kinds-of-coins 4) 25)
        ((= kinds-of-coins 5) 50)))
```

### Решение

После подстановки, процедура породит следующее дерево иллюстрирующее этот процесс:

```racket
(cc 11 5)

(+ (cc 11 4)
   (cc -39 5))

(+ (+ (cc 11 3)
      (cc -14 4))
   0)

(+ (+ (+ (cc 11 2)
         (cc 1 3))
      0)
    0)

(+ (+ (+ (+ (cc 11 1)
            (cc 6 2))
         (+ (cc 1 2)
            (cc -9 3)))
      0)
    0)

(+ (+ (+ (+ (+ (cc 11 0)
               (cc 10 1))
            (+ (cc 6 1)
               (cc 1 2)))
         (+ (+ (cc 1 1)
               (cc -4 2))
            0))
      0)
    0)

(+ (+ (+ (+ (+ (+ 0
                  (+ (cc 10 0)
                     (сс 9 1)))
            (+ (+ (cc 6 0)
                  (cc 5 1))
               (+ (сс 1 1)
                  (сс -3 2))))
         (+ (+ (+ (сс 1 0)
                  (сс 0 1))
               0)
            0))
      0)
    0)

(+ (+ (+ (+ (+ (+ 0
                  (+ 0
                     (+ (cc 9 0)
                        (cc 8 1))))
            (+ (+ 0
                  (+ (cc 5 0)
                     (cc 4 1)))
               (+ (+ (cc 1 0)
                     (cc 0 1))
                  0)))
         1)
      0)
    0)

(+ (+ (+ (+ (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ (cc 8 0)
                           (cc 7 1)))))
            (+ (+ 0
                  (+ 0
                     (+ (cc 4 0)
                        (cc 3 1))))
               1))
         1)
      0)
    0)

(+ (+ (+ (+ (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ 0
                           (+ (cc 7 0)
                              (cc 6 1))))))
            (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ (cc 3 0)
                           (cc 2 1)))))
               1))
         1)
      0)
    0)

(+ (+ (+ (+ (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ 0
                           (+ 0
                              (+ (cc 6 0)
                                 (cc 5 1)))))))
            (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ 0
                           (+ (cc 2 0)
                              (cc 1 1))))))
               1))
         1)
      0)
    0)

(+ (+ (+ (+ (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ 0
                           (+ 0
                              (+ 0
                                 (+ (cc 5 0)
                                    (cc 4 1))))))))
            (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ 0
                           (+ 0
                              (+ (cc 1 0)
                                 (cc 0 1)))))))
               1))
         1)
      0)
    0)

(+ (+ (+ (+ (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ 0
                           (+ 0
                              (+ 0
                                 (+ 0
                                    (+ (cc 4 0)
                                       (cc 3 1)))))))))
            (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ 0
                           (+ 0
                              (+ 0
                                 1))))))
               1))
         1)
      0)
    0)

(+ (+ (+ (+ (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ 0
                           (+ 0
                              (+ 0
                                 (+ 0
                                    (+ 0
                                       (+ (cc 3 0)
                                          (cc 2 1))))))))))
            2)
         1)
      0)
    0)

(+ (+ (+ (+ (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ 0
                           (+ 0
                              (+ 0
                                 (+ 0
                                    (+ 0
                                       (+ 0
                                          (+ (cc 2 0)
                                             (cc 1 1)))))))))))
            2)
         1)
      0)
    0)

(+ (+ (+ (+ (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ 0
                           (+ 0
                              (+ 0
                                 (+ 0
                                    (+ 0
                                       (+ 0
                                          (+ 0
                                             (+ (cc 1 0)
                                                (cc 0 1))))))))))))
            2)
         1)
      0)
    0)

(+ (+ (+ (+ (+ (+ 0
                  (+ 0
                     (+ 0
                        (+ 0
                           (+ 0
                              (+ 0
                                 (+ 0
                                    (+ 0
                                       (+ 0
                                          (+ 0
                                             (+ 0
                                                1)))))))))))
            2)
         1)
      0)
    0)


4
```
Иллюстрация от Кена Дика, получившегося дерева
![Procedure tree](https://kendyck.files.wordpress.com/2016/05/sicp-ex1-14.png)

Т.к высота дерева, с увеличением суммы которую нужно посчитать растет линейно, то и рост памяти будет линеен `Θ(n)`

Если номинал монет не менятся, то для `(cc n 1)` порядок роста будет `O(n)`. Для `(cc n 2)`,  нужно вычислить `(cc n 1)` и `(cc n-5 2)`. Повторив эту редукцию для второго выражения примерно `n/5` раз  получим результат. Т.е нам потребуется примерно `n/5` итераций, на каждой из которых делается `Θ(n)` шагов, а значит общее число шагов будет `Θ(n²)`.

Таким образом приходим к выводу что число шагов равно `Θ(nᵏ)`, где n – сумма для размена, k – число номиналов монет. В нашем случае с пятью номиналами ответ получается Θ(n⁵).